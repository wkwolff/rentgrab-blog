---
import BaseLayout from '@/layouts/BaseLayout.astro';
---

<BaseLayout 
  title="Contact Us - RentGrab Blog"
  description="Get in touch with the RentGrab team. We'd love to hear from you about equipment rental insights, partnership opportunities, or any questions."
  keywords={['contact', 'RentGrab', 'equipment rental', 'support', 'help']}
>
  <div class="container-lg py-12">
    <div class="max-w-2xl mx-auto">
      <!-- Page Header -->
      <div class="text-center mb-12">
        <h1 class="text-h1 mb-4">Get in Touch</h1>
        <p class="text-lead text-neutral-600">
          Have a question about the sharing economy, want to share your story, or interested in early access? We'd love to hear from you.
        </p>
      </div>

      <!-- Contact Form -->
      <div class="bg-white rounded-lg shadow-sm border border-neutral-200 p-8">
        <form id="contactForm" class="space-y-6">
          <!-- Name Fields -->
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div>
              <label for="firstname" class="block text-small font-medium text-neutral-700 mb-2">
                First Name <span class="text-primary-500">*</span>
              </label>
              <input
                type="text"
                id="firstname"
                name="firstname"
                required
                class="w-full px-4 py-3 border border-neutral-200 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                placeholder="John"
              />
            </div>
            <div>
              <label for="lastname" class="block text-small font-medium text-neutral-700 mb-2">
                Last Name <span class="text-primary-500">*</span>
              </label>
              <input
                type="text"
                id="lastname"
                name="lastname"
                required
                class="w-full px-4 py-3 border border-neutral-200 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                placeholder="Doe"
              />
            </div>
          </div>

          <!-- Email Field -->
          <div>
            <label for="email" class="block text-small font-medium text-neutral-700 mb-2">
              Email Address <span class="text-primary-500">*</span>
            </label>
            <input
              type="email"
              id="email"
              name="email"
              required
              class="w-full px-4 py-3 border border-neutral-200 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
              placeholder="john@example.com"
            />
          </div>

          <!-- Subject Field (Optional) -->
          <div>
            <label for="subject" class="block text-small font-medium text-neutral-700 mb-2">
              Subject
            </label>
            <input
              type="text"
              id="subject"
              name="subject"
              class="w-full px-4 py-3 border border-neutral-200 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
              placeholder="How can we help?"
            />
          </div>

          <!-- Message Field -->
          <div>
            <label for="message" class="block text-small font-medium text-neutral-700 mb-2">
              Message <span class="text-primary-500">*</span>
            </label>
            <textarea
              id="message"
              name="message"
              rows="6"
              required
              class="w-full px-4 py-3 border border-neutral-200 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none"
              placeholder="Tell us what's on your mind..."
            ></textarea>
          </div>

          <!-- Submit Button -->
          <button
            type="submit"
            class="w-full btn-primary py-3 text-center"
          >
            Send Message
          </button>
        </form>

        <!-- Success Message -->
        <div id="contactSuccessMessage" class="hidden mt-6 p-4 bg-green-50 border border-green-200 text-green-700 rounded-lg">
          <div class="flex items-start gap-3">
            <svg class="w-5 h-5 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
            </svg>
            <div>
              <p class="font-medium">Thank you for reaching out!</p>
              <p class="text-small mt-1">We'll get back to you within 24 hours.</p>
            </div>
          </div>
        </div>

        <!-- Error Message -->
        <div id="contactErrorMessage" class="hidden mt-6 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg">
          <div class="flex items-start gap-3">
            <svg class="w-5 h-5 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
            </svg>
            <div>
              <p class="font-medium">Something went wrong</p>
              <p class="text-small mt-1">Please try again or email us directly at support@rentgrab.com</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Additional Contact Info -->
      <div class="mt-12 text-center">
        <h2 class="text-h3 mb-6">Other Ways to Connect</h2>
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
          <!-- Email -->
          <a href="mailto:support@rentgrab.com" class="group p-6 bg-neutral-50 rounded-lg hover:bg-primary-50 transition-colors">
            <svg class="w-8 h-8 mx-auto mb-3 text-neutral-600 group-hover:text-primary-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
            </svg>
            <p class="font-semibold text-neutral-900">Email Us</p>
            <p class="text-small text-neutral-600 mt-1">support@rentgrab.com</p>
          </a>

          <!-- Social Media -->
          <a href="https://www.linkedin.com/company/rentgrab" target="_blank" rel="noopener noreferrer" class="group p-6 bg-neutral-50 rounded-lg hover:bg-primary-50 transition-colors">
            <svg class="w-8 h-8 mx-auto mb-3 text-neutral-600 group-hover:text-primary-500" fill="currentColor" viewBox="0 0 24 24">
              <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
            </svg>
            <p class="font-semibold text-neutral-900">LinkedIn</p>
            <p class="text-small text-neutral-600 mt-1">Follow us</p>
          </a>

          <!-- Main Platform -->
          <a href="https://rentgrab.com" target="_blank" rel="noopener noreferrer" class="group p-6 bg-neutral-50 rounded-lg hover:bg-primary-50 transition-colors">
            <svg class="w-8 h-8 mx-auto mb-3 text-neutral-600 group-hover:text-primary-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"></path>
            </svg>
            <p class="font-semibold text-neutral-900">Visit RentGrab</p>
            <p class="text-small text-neutral-600 mt-1">Main platform</p>
          </a>
        </div>
      </div>
    </div>
  </div>
</BaseLayout>

<script>
  // HubSpot configuration for contact form
  const CONTACT_HUBSPOT_PORTAL_ID = '50196841';
  const CONTACT_HUBSPOT_FORM_ID = '9027e5fd-30d7-4d08-8a49-dbc4493596a3';

  // Helper function to get cookies
  function getCookie(name: string): string | null {
    const value = `; ${document.cookie}`;
    const parts = value.split(`; ${name}=`);
    if (parts.length === 2) {
      return parts.pop()?.split(';').shift() || null;
    }
    return null;
  }

  // Contact form submission handler
  const contactForm = document.getElementById('contactForm') as HTMLFormElement;
  
  if (contactForm) {
    contactForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const formData = new FormData(contactForm);
      const submitButton = contactForm.querySelector('button[type="submit"]') as HTMLButtonElement;
      const originalButtonText = submitButton?.textContent || 'Send Message';
      
      // Hide any previous messages
      document.getElementById('contactSuccessMessage')?.classList.add('hidden');
      document.getElementById('contactErrorMessage')?.classList.add('hidden');
      
      // Show loading state
      if (submitButton) {
        submitButton.disabled = true;
        submitButton.textContent = 'Sending...';
      }
      
      try {
        // Prepare HubSpot submission data
        const hubspotData = {
          fields: [
            {
              name: 'firstname',
              value: formData.get('firstname') as string
            },
            {
              name: 'lastname',
              value: formData.get('lastname') as string
            },
            {
              name: 'email',
              value: formData.get('email') as string
            },
            {
              name: 'message',
              value: formData.get('message') as string
            }
          ],
          context: {
            pageUri: window.location.href,
            pageName: document.title
          }
        };
        
        // Add subject if provided (as part of message for simplicity)
        const subject = formData.get('subject') as string;
        if (subject) {
          const messageField = hubspotData.fields.find(f => f.name === 'message');
          if (messageField) {
            messageField.value = `Subject: ${subject}\n\n${messageField.value}`;
          }
        }
        
        // Add HubSpot tracking cookie if available
        const hutk = getCookie('hubspotutk');
        if (hutk) {
          (hubspotData.context as any).hutk = hutk;
        }
        
        // Submit to HubSpot
        const response = await fetch(
          `https://api.hsforms.com/submissions/v3/integration/submit/${CONTACT_HUBSPOT_PORTAL_ID}/${CONTACT_HUBSPOT_FORM_ID}`,
          {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(hubspotData)
          }
        );
        
        if (response.ok) {
          // Show success message
          document.getElementById('contactSuccessMessage')?.classList.remove('hidden');
          
          // Reset form
          contactForm.reset();
          
          // Track with Google Analytics if available
          if (typeof gtag !== 'undefined') {
            gtag('event', 'contact_form_submit', {
              'event_category': 'Form',
              'event_label': 'Contact Form'
            });
          }
          
          // Scroll to success message
          document.getElementById('contactSuccessMessage')?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          
          // Reset button
          if (submitButton) {
            submitButton.textContent = originalButtonText;
            submitButton.disabled = false;
          }
        } else {
          throw new Error('HubSpot submission failed');
        }
      } catch (error) {
        // Show error message
        console.error('Contact form submission error:', error);
        document.getElementById('contactErrorMessage')?.classList.remove('hidden');
        
        // Reset button
        if (submitButton) {
          submitButton.textContent = originalButtonText;
          submitButton.disabled = false;
        }
        
        // Scroll to error message
        document.getElementById('contactErrorMessage')?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }
    });
  }
</script>

<style>
  /* Additional form styles */
  form input:focus,
  form textarea:focus {
    box-shadow: 0 0 0 3px rgba(255, 56, 92, 0.1);
  }
  
  form button:disabled {
    opacity: 0.7;
    cursor: not-allowed;
  }
</style>